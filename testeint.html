<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Integração do Google Calendar</title>
</head>
<body>
    <h1>Calendário do Google</h1>
    <button id="authorize-button">Autorizar</button>
    <button id="list-events-button">Listar Eventos</button>
    
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: 'SUA_API_KEY',
                clientId: 'SEU_ID_DE_CLIENTE',
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
                scope: 'https://www.googleapis.com/auth/calendar',
            }).then(function () {
                // Verifique se o usuário já está autenticado
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());

                // Adicione manipuladores de eventos aos botões
                document.getElementById('authorize-button').onclick = handleAuthClick;
                document.getElementById('list-events-button').onclick = listUpcomingEvents;
            });
        }

        function handleAuthClick() {
            gapi.auth2.getAuthInstance().signIn();
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                document.getElementById('authorize-button').style.display = 'none';
                document.getElementById('list-events-button').style.display = 'block';
            } else {
                document.getElementById('authorize-button').style.display = 'block';
                document.getElementById('list-events-button').style.display = 'none';
            }
        }

        function listUpcomingEvents() {
            gapi.client.calendar.events.list({
                'calendarId': 'SEU_ID_DE_CALENDÁRIO',
                'timeMin': new Date().toISOString(),
                'showDeleted': false,
                'singleEvents': true,
                'maxResults': 10,
                'orderBy': 'startTime',
            }).then(function (response) {
                const events = response.result.items;
                console.log('Eventos:', events);
            });
        }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</body>
</html>
